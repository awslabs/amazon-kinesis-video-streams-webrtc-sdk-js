/* Amazon Kinesis Video Streams WebRTC SDK for JavaScript v1.0.8
Copyright 2019-2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.

This product includes software developed at
Amazon Web Services, Inc. (http://aws.amazon.com/).

License at kvs-webrtc.LICENSE */
window.KVSWebRTC=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.MASTER="MASTER",e.VIEWER="VIEWER"}(t.Role||(t.Role={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return i})),n.d(t,"__assign",(function(){return o})),n.d(t,"__rest",(function(){return s})),n.d(t,"__decorate",(function(){return a})),n.d(t,"__param",(function(){return u})),n.d(t,"__metadata",(function(){return c})),n.d(t,"__awaiter",(function(){return l})),n.d(t,"__generator",(function(){return f})),n.d(t,"__exportStar",(function(){return d})),n.d(t,"__values",(function(){return h})),n.d(t,"__read",(function(){return p})),n.d(t,"__spread",(function(){return y})),n.d(t,"__spreadArrays",(function(){return v})),n.d(t,"__await",(function(){return g})),n.d(t,"__asyncGenerator",(function(){return m})),n.d(t,"__asyncDelegator",(function(){return _})),n.d(t,"__asyncValues",(function(){return b})),n.d(t,"__makeTemplateObject",(function(){return w})),n.d(t,"__importStar",(function(){return S})),n.d(t,"__importDefault",(function(){return O}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function s(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function a(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}function u(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,a)}u((r=r.apply(e,t||[])).next())}))}function f(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function d(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function h(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}function v(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function g(e){return this instanceof g?(this.v=e,this):new g(e)}function m(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{(n=i[e](t)).value instanceof g?Promise.resolve(n.value.v).then(u,c):l(o[0][2],n)}catch(e){l(o[0][3],e)}var n}function u(e){a("next",e)}function c(e){a("throw",e)}function l(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function _(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:g(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function b(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=h(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}function w(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function O(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=r.__importDefault(n(7)),o=n(3),s=function(){function e(t,n,r){void 0===r&&(r=e.DEFAULT_SERVICE),this.region=t,this.credentials=n,this.service=r}return e.prototype.getSignedURL=function(t,n,i){return void 0===i&&(i=new Date),r.__awaiter(this,void 0,Promise,(function(){var s,a,u,c,l,f,d,h,p,y,v,g,m,_,b,w,S,O,E,C,I,A,N;return r.__generator(this,(function(r){switch(r.label){case 0:return"function"!=typeof this.credentials.getPromise?[3,2]:[4,this.credentials.getPromise()];case 1:r.sent(),r.label=2;case 2:if(o.validateValueNonNil(this.credentials.accessKeyId,"credentials.accessKeyId"),o.validateValueNonNil(this.credentials.secretAccessKey,"credentials.secretAccessKey"),s=e.getDateTimeString(i),a=e.getDateString(i),c=(u="wss")+"://",!t.startsWith(c))throw new Error("Endpoint '"+t+"' is not a secure WebSocket endpoint. It should start with '"+c+"'.");if(t.includes("?"))throw new Error("Endpoint '"+t+"' should not contain any query parameters.");return(l=t.indexOf("/",c.length))<0?(f=t.substring(c.length),d="/"):(f=t.substring(c.length,l),d=t.substring(l)),h=["host"].join(";"),p="GET",y=a+"/"+this.region+"/"+this.service+"/aws4_request",v=Object.assign({},n,{"X-Amz-Algorithm":e.DEFAULT_ALGORITHM,"X-Amz-Credential":this.credentials.accessKeyId+"/"+y,"X-Amz-Date":s,"X-Amz-Expires":"299","X-Amz-SignedHeaders":h}),this.credentials.sessionToken&&Object.assign(v,{"X-Amz-Security-Token":this.credentials.sessionToken}),g=e.createQueryString(v),m={host:f},_=e.createHeadersString(m),[4,e.sha256("")];case 3:return b=r.sent(),w=[p,d,g,_,h,b].join("\n"),[4,e.sha256(w)];case 4:return S=r.sent(),O=[e.DEFAULT_ALGORITHM,s,y,S].join("\n"),[4,this.getSignatureKey(a)];case 5:return E=r.sent(),A=(I=e).toHex,[4,e.hmac(E,O)];case 6:return[4,A.apply(I,[r.sent()])];case 7:return C=r.sent(),N=Object.assign({},v,{"X-Amz-Signature":C}),[2,u+"://"+f+d+"?"+e.createQueryString(N)]}}))}))},e.prototype.getSignatureKey=function(t){return r.__awaiter(this,void 0,Promise,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,e.hmac("AWS4"+this.credentials.secretAccessKey,t)];case 1:return n=r.sent(),[4,e.hmac(n,this.region)];case 2:return i=r.sent(),[4,e.hmac(i,this.service)];case 3:return o=r.sent(),[4,e.hmac(o,"aws4_request")];case 4:return[2,r.sent()]}}))}))},e.createHeadersString=function(e){return Object.keys(e).map((function(t){return t+":"+e[t]+"\n"})).join()},e.createQueryString=function(e){return Object.keys(e).sort().map((function(t){return t+"="+encodeURIComponent(e[t])})).join("&")},e.getDateTimeString=function(e){return e.toISOString().replace(/\.\d{3}Z$/,"Z").replace(/[:\-]/g,"")},e.getDateString=function(e){return this.getDateTimeString(e).substring(0,8)},e.sha256=function(e){return r.__awaiter(this,void 0,Promise,(function(){var t;return r.__generator(this,(function(n){switch(n.label){case 0:return[4,i.default.subtle.digest({name:"SHA-256"},this.toUint8Array(e))];case 1:return t=n.sent(),[2,this.toHex(t)]}}))}))},e.hmac=function(e,t){return r.__awaiter(this,void 0,Promise,(function(){var n,o,s;return r.__generator(this,(function(r){switch(r.label){case 0:return n="string"==typeof e?this.toUint8Array(e).buffer:e,o=this.toUint8Array(t).buffer,[4,i.default.subtle.importKey("raw",n,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"])];case 1:return s=r.sent(),[4,i.default.subtle.sign({name:"HMAC",hash:{name:"SHA-256"}},s,o)];case 2:return[2,r.sent()]}}))}))},e.toUint8Array=function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0,i=e.length;r<i;r++)n[r]=e.charCodeAt(r);return n},e.toHex=function(e){return Array.from(new Uint8Array(e)).map((function(e){return e.toString(16).padStart(2,"0")})).join("")},e.DEFAULT_ALGORITHM="AWS4-HMAC-SHA256",e.DEFAULT_SERVICE="kinesisvideo",e}();t.SigV4RequestSigner=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateValueNonNil=function(e,t){if(null===e)throw new Error(t+" cannot be null");if(void 0===e)throw new Error(t+" cannot be undefined");if(""===e)throw new Error(t+" cannot be empty")},t.validateValueNil=function(e,t){if(null!=e&&""!==e)throw new Error(t+" should be null")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.Role=r.Role;var i=n(5);t.SignalingClient=i.SignalingClient;var o=n(2);t.SigV4RequestSigner=o.SigV4RequestSigner;var s=n(9);t.QueryParams=s.QueryParams;var a=n(10);t.RequestSigner=a.RequestSigner,t.VERSION="1.0.8"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,o=n(1),s=n(6),a=n(0),u=n(2),c=o.__importDefault(n(8)),l=n(3);!function(e){e.SDP_ANSWER="SDP_ANSWER",e.SDP_OFFER="SDP_OFFER",e.ICE_CANDIDATE="ICE_CANDIDATE"}(r||(r={})),function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED"}(i||(i={}));var f=function(e){function t(t){var n=e.call(this)||this;return n.websocket=null,n.readyState=i.CLOSED,n.pendingIceCandidatesByClientId={},n.hasReceivedRemoteSDPByClientId={},l.validateValueNonNil(t,"SignalingClientConfig"),l.validateValueNonNil(t.role,"role"),t.role===a.Role.VIEWER?l.validateValueNonNil(t.clientId,"clientId"):l.validateValueNil(t.clientId,"clientId"),l.validateValueNonNil(t.channelARN,"channelARN"),l.validateValueNonNil(t.region,"region"),l.validateValueNonNil(t.channelEndpoint,"channelEndpoint"),n.config=o.__assign({},t),t.requestSigner?n.requestSigner=t.requestSigner:(l.validateValueNonNil(t.credentials,"credentials"),n.requestSigner=new u.SigV4RequestSigner(t.region,t.credentials)),n.dateProvider=new c.default(t.systemClockOffset||0),n.onOpen=n.onOpen.bind(n),n.onMessage=n.onMessage.bind(n),n.onError=n.onError.bind(n),n.onClose=n.onClose.bind(n),n}return o.__extends(t,e),t.prototype.open=function(){var e=this;if(this.readyState!==i.CLOSED)throw new Error("Client is already open, opening, or closing");this.readyState=i.CONNECTING,this.asyncOpen().then().catch((function(t){return e.onError(t)}))},t.prototype.asyncOpen=function(){return o.__awaiter(this,void 0,Promise,(function(){var e,t;return o.__generator(this,(function(n){switch(n.label){case 0:return e={"X-Amz-ChannelARN":this.config.channelARN},this.config.role===a.Role.VIEWER&&(e["X-Amz-ClientId"]=this.config.clientId),[4,this.requestSigner.getSignedURL(this.config.channelEndpoint,e,this.dateProvider.getDate())];case 1:return t=n.sent(),this.readyState!==i.CONNECTING?[2]:(this.websocket=new WebSocket(t),this.websocket.addEventListener("open",this.onOpen),this.websocket.addEventListener("message",this.onMessage),this.websocket.addEventListener("error",this.onError),this.websocket.addEventListener("close",this.onClose),[2])}}))}))},t.prototype.close=function(){null!==this.websocket?(this.readyState=i.CLOSING,this.websocket.close()):this.readyState!==i.CLOSED&&this.onClose()},t.prototype.sendSdpOffer=function(e,t){this.sendMessage(r.SDP_OFFER,e.toJSON(),t)},t.prototype.sendSdpAnswer=function(e,t){this.sendMessage(r.SDP_ANSWER,e.toJSON(),t)},t.prototype.sendIceCandidate=function(e,t){this.sendMessage(r.ICE_CANDIDATE,e.toJSON(),t)},t.prototype.sendMessage=function(e,n,r){if(this.readyState!==i.OPEN)throw new Error("Could not send message because the connection to the signaling service is not open.");this.validateRecipientClientId(r),this.websocket.send(JSON.stringify({action:e,messagePayload:t.serializeJSONObjectAsBase64String(n),recipientClientId:r||void 0}))},t.prototype.cleanupWebSocket=function(){null!==this.websocket&&(this.websocket.removeEventListener("open",this.onOpen),this.websocket.removeEventListener("message",this.onMessage),this.websocket.removeEventListener("error",this.onError),this.websocket.removeEventListener("close",this.onClose),this.websocket=null)},t.prototype.onOpen=function(){this.readyState=i.OPEN,this.emit("open")},t.prototype.onMessage=function(e){var n,i;try{n=JSON.parse(e.data),i=t.parseJSONObjectFromBase64String(n.messagePayload)}catch(e){return}var o=n.messageType,s=n.senderClientId;switch(o){case r.SDP_OFFER:return this.emit("sdpOffer",i,s),void this.emitPendingIceCandidates(s);case r.SDP_ANSWER:return this.emit("sdpAnswer",i,s),void this.emitPendingIceCandidates(s);case r.ICE_CANDIDATE:return void this.emitOrQueueIceCandidate(i,s)}},t.parseJSONObjectFromBase64String=function(e){return JSON.parse(atob(e))},t.serializeJSONObjectAsBase64String=function(e){return btoa(JSON.stringify(e))},t.prototype.emitOrQueueIceCandidate=function(e,n){var r=n||t.DEFAULT_CLIENT_ID;this.hasReceivedRemoteSDPByClientId[r]?this.emit("iceCandidate",e,n):(this.pendingIceCandidatesByClientId[r]||(this.pendingIceCandidatesByClientId[r]=[]),this.pendingIceCandidatesByClientId[r].push(e))},t.prototype.emitPendingIceCandidates=function(e){var n=this,r=e||t.DEFAULT_CLIENT_ID;this.hasReceivedRemoteSDPByClientId[r]=!0;var i=this.pendingIceCandidatesByClientId[r];i&&(delete this.pendingIceCandidatesByClientId[r],i.forEach((function(t){n.emit("iceCandidate",t,e)})))},t.prototype.validateRecipientClientId=function(e){if(this.config.role===a.Role.MASTER&&!e)throw new Error("Missing recipient client id. As the MASTER, all messages must be sent with a recipient client id.");if(this.config.role===a.Role.VIEWER&&e)throw new Error("Unexpected recipient client id. As the VIEWER, messages must not be sent with a recipient client id.")},t.prototype.onError=function(e){this.emit("error",e)},t.prototype.onClose=function(){this.readyState=i.CLOSED,this.cleanupWebSocket(),this.emit("close")},t.DEFAULT_CLIENT_ID="MASTER",t}(s.EventEmitter);t.SignalingClient=f},function(e,t,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var u=10;function c(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function l(e,t,n,r){var i,o,s,a;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=c(e))>0&&s.length>i&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,a=u,console&&console.warn&&console.warn(a)}return e}function f(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,o(this.listener,this.target,e))}function d(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=f.bind(r);return i.listener=n,r.wrapFn=i,i}function h(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):y(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function y(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var u=i[e];if(void 0===u)return!1;if("function"==typeof u)o(u,this,t);else{var c=u.length,l=y(u,c);for(n=0;n<c;++n)o(l[n],this,t)}return!0},a.prototype.addListener=function(e,t){return l(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return l(this,e,t,!0)},a.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,d(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,d(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,r,i,o,s;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},a.prototype.listeners=function(e){return h(this,e,!0)},a.prototype.rawListeners=function(e){return h(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},a.prototype.listenerCount=p,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(e,t){e.exports=window.crypto},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.clockOffsetMs=e}return e.prototype.getDate=function(){return new Date(Date.now()+this.clockOffsetMs)},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}]);